<h1>Keep On Padding</h1>
<table class="table meta-table table-condensed">
  <tbody>
    <tr>
      <td class="header-column"><strong>Contributed by</strong></td>
      <td>A. P. Marki</td>
    </tr>
    <tr>
      <td><strong>Source</strong></td>
      <td>N/A</td>
    </tr>
    <tr>
      <td><strong>Tested with Scala version</strong></td>
      <td>2.10.0-RC1</td>
    </tr>
  </tbody>
</table>
<div class="code-snippet">
  <h3>What is the result of executing the following code?</h3>
  <pre class="prettyprint lang-scala">
def padTo(width: Int)(sb: StringBuilder) = {
  0 until (width - sb.length) foreach {
    sb.append('*')
  }
  sb
}

// sb.length == 14
val sb = new StringBuilder("Hello, kitteh!")
println(padTo(20)(sb))
  </pre>
  <ol>
<li><pre class="prettyprint lang-scala">
Hello, kitteh!******
</pre></li>
<li><pre class="prettyprint lang-scala">
******
</pre></li>
<li id="correct-answer"><pre class="prettyprint lang-scala">
Hello, kitteh!*
</pre></li>
<li>
Fails with a compilation exception
</li>
  </ol>
</div>
<button id="show-and-tell" class="btn btn-primary" href="#">Display the correct answer, explanation and comments</button>
<div id="explanation" class="explanation" style="display:none">
  <h3>Explanation</h3>
  <p>
Recall that Scala has a
<tt>StringBuilder</tt> that
<a href="http://www.artima.com/pins1ed/working-with-lists.html#footnote16-5">
shadows <tt>java.lang.StringBuilder</tt>
</a>
and that it has an
<a href="http://www.scala-lang.org/api/current/index.html#scala.collection.mutable.StringBuilder">
<tt>apply</tt>
</a>
method.
  </p>
  <p>
The <tt>foreach</tt> takes a function with an Int parameter.
<tt>StringBuilder.append</tt> returns a <tt>StringBuilder</tt>
which, as a <tt>Seq</tt>, is such a function; that function is eta-expanded.
The <tt>append</tt> is evaluated once at eta-expansion;
each iteration invokes <tt>StringBuilder.apply</tt>, which is an
alias for <tt>StringBuilder.charAt</tt>.
If the <tt>StringBuilder</tt> had not been initialized with data,
that invocation would throw <tt>StringIndexOutOfBoundsException</tt>:
<pre class="prettyprint lang-scala">
val sb2 = new StringBuilder()
println(padTo(20)(sb2)) // throws StringIndexOutOfBoundsException
</pre>.
  </p>
</div>